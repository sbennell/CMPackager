<ApplicationDef>
	<Application>
		<Name>Adobe Acrobat Reader DC</Name>
		<Description>More powerful than other PDF software, Adobe Acrobat Reader DC is the free, trusted standard for viewing, printing and annotating PDFs.</Description>
		<Publisher>Adobe</Publisher>
		<AutoInstall>True</AutoInstall>
		<UserDocumentation>https://acrobat.adobe.com/us/en/acrobat/pdf-reader.html</UserDocumentation>
		<Icon>AdobeReader.ico</Icon>
		<FolderPath>AdobeReader</FolderPath>
	</Application>
	<Downloads>
		<Download DeploymentType="DeploymentType1">
			<PrefetchScript>$latestVersion = (((Invoke-WebRequest https://www.adobe.com/devnet-docs/acrobatetk/tools/ReleaseNotesDC/index.html) |Select-Object -ExpandProperty Links | where {$_.outertext -like "2* Planned Update, *"} |where {$_.href -like "continuous*"}|Sort-Object -Property innerText -Descending).innerText).Split(" ").replace(".","")[0]
$LatestVersion = $latestVersion.Replace("x",5)
			$URL = "http://ardownload.adobe.com/pub/adobe/reader/win/AcrobatDC/$($latestVersion)/AcroRdrDC$($LatestVersion)_en_US.exe"
Add-LogContent $LatestVersion
Add-LogContent $URL</PrefetchScript>
			<URL></URL>
			<DownloadFileName>InstallReaderDC.exe</DownloadFileName>
			<Version></Version>
			<FullVersion></FullVersion>
			<DownloadVersionCheck>$Version = (((Get-item $TempDir\InstallReaderDC.exe).VersionInfo.FileVersion).Substring(0,10))
			$FileVersion = ((Get-item $TempDir\InstallReaderDC.exe).VersionInfo.FileVersion)</DownloadVersionCheck>
			<ExtraCopyFunctions>&amp; $ScriptRoot\7za.exe x "$TempDir\InstallReaderDC.exe" -o"$TempDir\AdobeReaderTemp" -y
			Copy-Item $TempDir\AdobeReaderTemp\* -Destination $DestinationPath -Force -Recurse
			# You can Create an Adobe Reader MST and have it copied here
			Start-Sleep 60
			copy-item $ScriptRoot\ExtraFiles\AdobeReaderDC\AcroRead.mst -Destination $DestinationPath\AcroRead.mst -Force -EA SilentlyContinue
						
			$GetPATCH = Get-ChildItem "$DestinationPath\AcroRdrDCUp*.msp"
			$PATCH = $GetPATCH.Name

			Clear-Content $DestinationPath\setup.ini
			Add-Content $DestinationPath\setup.ini "[Startup]"
			Add-Content $DestinationPath\setup.ini "RequireMSI=3.0"
			Add-Content $DestinationPath\setup.ini "CmdLine=/sall /rs"
			Add-Content $DestinationPath\setup.ini ""
			Add-Content $DestinationPath\setup.ini "[Product]"
			Add-Content $DestinationPath\setup.ini "PATCH=$PATCH"
			Add-Content $DestinationPath\setup.ini "msi=AcroRead.msi"
			Add-Content $DestinationPath\setup.ini "CmdLine=TRANSFORMS=`"AcroRead.mst`""
			</ExtraCopyFunctions>
		</Download>
	</Downloads>
	<DeploymentTypes>
		<DeploymentType Name="DeploymentType1">
			<DeploymentTypeName>Adobe Reader DC Silent Install</DeploymentTypeName>
			<InstallationType>MSI</InstallationType>
			<CacheContent>False</CacheContent>
			<BranchCache>True</BranchCache>
			<ContentFallback>True</ContentFallback>
			<OnSlowNetwork>Download</OnSlowNetwork>
			<InstallProgram>Setup.exe</InstallProgram>
			<InstallationMSI>AcroRead.msi</InstallationMSI>
			<InstallationBehaviorType>InstallForSystem</InstallationBehaviorType>
			<LogonReqType>WhetherOrNotUserLoggedOn</LogonReqType>
			<UserInteractionMode>Hidden</UserInteractionMode>
			<EstRuntimeMins>15</EstRuntimeMins>
			<MaxRuntimeMins>60</MaxRuntimeMins>
			<RebootBehavior>BasedOnExitCode</RebootBehavior>
			<DetectionMethodType>MSI</DetectionMethodType>
			<CustomDetectionMethods>
				<DetectionClause>
					<DetectionClauseType>File</DetectionClauseType>
					<Name>AcroRd32.exe</Name>
					<Path>%ProgramFiles(x86)%\Adobe\Acrobat Reader DC\Reader</Path>
					<PropertyType>Version</PropertyType>
					<ExpectedValue>$FileVersion</ExpectedValue>
					<ExpressionOperator>IsEquals</ExpressionOperator>
					<Value>True</Value>
					<Is64Bit></Is64Bit>
				</DetectionClause>
			</CustomDetectionMethods>
			<RequirementsRules>
				<RequirementsRule>
					<RequirementsRuleType>OperatingSystem</RequirementsRuleType>
					<RequirementsRuleValue>
						<RuleValue>Windows/All_x64_Windows_11_and_higher_Clients</RuleValue>
						<RuleValue>Windows/All_x86_Windows_10_and_higher_Clients</RuleValue>
						<RuleValue>Windows/All_x86_Windows_8.1_Client</RuleValue>
						<RuleValue>Windows/All_x64_Windows_10_and_higher_Clients</RuleValue>
						<RuleValue>Windows/All_x64_Windows_8.1_Client</RuleValue>
					</RequirementsRuleValue>
					<RequirementsRuleOperator>OneOf</RequirementsRuleOperator>
				</RequirementsRule>		
			</RequirementsRules>
		</DeploymentType>
	</DeploymentTypes>
	<Distribution>
		<DistributeContent>True</DistributeContent>
	</Distribution>
	<Supersedence>
		<Supersedence>True</Supersedence>
		<Uninstall>False</Uninstall>
	</Supersedence>
	<Deployment>
		<DeploySoftware>True</DeploySoftware>
		<UpdateSuperseded>True</UpdateSuperseded>
		<DeploymentCollection>All Users</DeploymentCollection>
		<DeployPurpose>Required</DeployPurpose>
	</Deployment>
</ApplicationDef>
